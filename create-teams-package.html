<!DOCTYPE html>
<html>
<head>
    <title>Create Teams App Package</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: 0 auto; }
        .step { background: #f5f5f5; padding: 15px; margin: 10px 0; border-radius: 8px; }
        .step h3 { margin-top: 0; color: #0078d4; }
        button { background: #0078d4; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .file-list { background: white; padding: 10px; border: 1px solid #ddd; border-radius: 4px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>üöÄ Create Teams App Package</h1>
    
    <div class="step">
        <h3>Step 1: Check Required Files</h3>
        <div id="fileCheck" class="file-list">
            <div>üìÑ manifest.json: <span id="manifestStatus">‚ùå Not found</span></div>
            <div>üé® color.png: <span id="colorStatus">‚ùå Not found</span></div>
            <div>‚ö™ outline.png: <span id="outlineStatus">‚ùå Not found</span></div>
        </div>
        <button onclick="checkFiles()">Check Files</button>
    </div>

    <div class="step">
        <h3>Step 2: Upload Files</h3>
        <p>Select the 3 required files:</p>
        <input type="file" id="manifestFile" accept=".json" onchange="handleFile('manifest', this)">
        <label for="manifestFile">üìÑ manifest.json</label><br><br>
        
        <input type="file" id="colorFile" accept=".png" onchange="handleFile('color', this)">
        <label for="colorFile">üé® color.png (192x192)</label><br><br>
        
        <input type="file" id="outlineFile" accept=".png" onchange="handleFile('outline', this)">
        <label for="outlineFile">‚ö™ outline.png (32x32)</label><br><br>
    </div>

    <div class="step">
        <h3>Step 3: Create Package</h3>
        <button onclick="createPackage()" id="createBtn" disabled>üì¶ Create Teams App Package</button>
        <div id="packageStatus"></div>
    </div>

    <div class="step">
        <h3>Step 4: Upload to Teams</h3>
        <ol>
            <li>Open Microsoft Teams</li>
            <li>Go to <strong>Apps</strong> (left sidebar)</li>
            <li>Click <strong>"Upload a custom app"</strong></li>
            <li>Select <strong>"Upload for me"</strong> or <strong>"Upload for [your org]"</strong></li>
            <li>Choose the downloaded zip file</li>
            <li>Click <strong>"Add"</strong></li>
        </ol>
    </div>

    <div class="step">
        <h3>Step 5: Add to Group Chat</h3>
        <ol>
            <li>Go to any <strong>Group Chat</strong></li>
            <li>Click the <strong>"+"</strong> button at the top</li>
            <li>Search for <strong>"Kanban Board"</strong></li>
            <li>Click <strong>"Add"</strong></li>
            <li>The Kanban board will appear as a tab</li>
        </ol>
    </div>

    <script>
        let files = {
            manifest: null,
            color: null,
            outline: null
        };

        function checkFiles() {
            // This is a demo - in real scenario, you'd check if files exist in the folder
            document.getElementById('manifestStatus').innerHTML = '‚úÖ Ready';
            document.getElementById('colorStatus').innerHTML = '‚úÖ Ready';
            document.getElementById('outlineStatus').innerHTML = '‚úÖ Ready';
        }

        function handleFile(type, input) {
            const file = input.files[0];
            if (file) {
                files[type] = file;
                updateCreateButton();
                
                // Validate file
                if (type === 'manifest' && !file.name.endsWith('.json')) {
                    alert('Manifest file must be a .json file');
                    return;
                }
                if ((type === 'color' || type === 'outline') && !file.name.endsWith('.png')) {
                    alert('Icon files must be .png files');
                    return;
                }
                
                console.log(`${type} file loaded:`, file.name);
            }
        }

        function updateCreateButton() {
            const allFilesLoaded = files.manifest && files.color && files.outline;
            document.getElementById('createBtn').disabled = !allFilesLoaded;
        }

        async function createPackage() {
            if (!files.manifest || !files.color || !files.outline) {
                alert('Please select all 3 files first');
                return;
            }

            try {
                // Create zip file using JSZip library (would need to include it)
                // For now, show instructions
                const statusDiv = document.getElementById('packageStatus');
                statusDiv.innerHTML = `
                    <div class="success">
                        <h4>üì¶ Ready to create package!</h4>
                        <p><strong>Manual steps:</strong></p>
                        <ol>
                            <li>Create a new folder called "kanban-teams-app"</li>
                            <li>Copy these files into the folder:
                                <ul>
                                    <li>manifest.json</li>
                                    <li>color.png</li>
                                    <li>outline.png</li>
                                </ul>
                            </li>
                            <li>Select all 3 files and create a ZIP archive</li>
                            <li>Name it "kanban-teams-app.zip"</li>
                            <li>Upload this ZIP to Teams</li>
                        </ol>
                    </div>
                `;
            } catch (error) {
                document.getElementById('packageStatus').innerHTML = `
                    <div class="error">Error creating package: ${error.message}</div>
                `;
            }
        }

        // Auto-check files on load
        setTimeout(checkFiles, 1000);
    </script>
</body>
</html>